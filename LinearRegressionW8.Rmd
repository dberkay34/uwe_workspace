---
title: "Week 8: Regression"
author: "Andrew Smith and others"
date: "20/03/2022"
output: html_document
---
```{r}
install.packages("ggplot2")
install.packages("performance")
install.packages("dplyr")
install.packages('see')
install.packages('patchwork')
```
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(performance)
library(dplyr)
```

# A simple linear regression using the cars dataset

## Summary statistics

```{r}
summary(cars)
```

## Scatter plot

Plot stopping distance (dist) against speed.

```{r}

library(ggplot2)
ggplot(cars, aes(x=speed, y=dist)) +
  geom_point() # + geom_smooth(method="lm")

# What does adding geom_smooth do?
```
```{r}
library(ggplot2)
ggplot(cars, aes(x=speed, y=dist)) +
  geom_point() # + geom_smooth(method="lm")
```

```{r}
library(ggplot2)
ggplot(cars, aes(x = speed, y= dist)) + geom_smooth(method = "lm") + geom_point()
```

What does this tell you?

Does this seem to be a good candidate for a simple linear regression?

## Correlation

Perform a linear correlation between these two variables.  Is the linear correlation statistically significant?

```{r}

with(cars, cor(speed,dist))
with(cars, cor.test(speed,dist))

```

## Linear regression

Model the stopping distance of these cars (from the 1920s). You will need to identify your dependent variable.

```{r}

model1 <- lm(dist ~ speed, data=cars)
summary(model1)

```

Interpret the output of the model.

How would you explain the regression equation to someone?


$$\mbox{distance} = \beta_0 + \beta_1 \times \mbox{speed}$$

## Model fit

Assess the performance of the model.

Does it show evidence of breaking model assumptions?
```{r}
```


```{r}

library(performance)
check_model(model1)

```

# Dewis exercise 'r regression'

Use the code chunk below to contain your code to answer the Dewis quesiton 

```{r Dewis}

# Start your code here


```


# The mtcars dataset


```{r}

library(dplyr)
df <- mtcars %>%
select(-c(am, vs, cyl, gear, carb))
glimpse(df)

```


Pick which variable is the best single variable for explaining the variation in miles per gallon (mpg), using a simple linear regression model.

Fully document your process, including your exploratory data analysis, model evaluation and selection.

How would you explain your chosen model to someone without technical expertise?

```{r}

## Summary statistics

## Correlation
### Hint: choose the variable that has the biggest correlation with miles per gallon

## Scatter plot

## Linear regression

## Interpretation

## Model fit

```





R packages mentioned today that you may find useful include:

- corrplot (for visualisation of correlations across a set of variables) <https://cran.r-project.org/web/packages/corrplot/vignettes/corrplot-intro.html>

- performance (for model evaluation and comparison) <https://easystats.github.io/see/articles/performance.html>

- kableExtra (for tables) <https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_html.html>
